(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{63:(e,r,t)=>{"use strict";var a=t(7260);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},106:(e,r,t)=>{Promise.resolve().then(t.bind(t,1321))},1321:(e,r,t)=>{"use strict";t.d(r,{default:()=>c});var a=t(5155),s=t(2115),n=t(8525),o=t(63),i=t(5299);let l=(0,t(1847).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function c(e){let{userId:r,userPayPalEmail:t,currentBalance:c}=e,[u,d]=(0,s.useState)(5e3),[m,p]=(0,s.useState)(t||""),[b,h]=(0,s.useState)(!1),[y,f]=(0,s.useState)({type:"",content:""}),x=(0,n.U)(),g=(0,o.useRouter)(),j=(.001*u).toFixed(2),N=async e=>{if(e.preventDefault(),h(!0),f({type:"",content:""}),u<5e3){f({type:"error",content:"L'importo minimo per il prelievo \xe8 ".concat(5e3," Creds.")}),h(!1);return}if(u>c){f({type:"error",content:"Saldo insufficiente."}),h(!1);return}if(!m){f({type:"error",content:"Per favore, inserisci la tua email PayPal."}),h(!1);return}let{error:t}=await x.from("payout_requests").insert({user_id:r,rwc_amount:u,usd_amount:parseFloat(j),method:"paypal",paypal_email:m,status:"pending"});if(t){f({type:"error",content:"Errore: ".concat(t.message)}),h(!1);return}let a=c-u,{error:s}=await x.from("profiles").update({rwc_balance:a,paypal_email:m}).eq("id",r);if(s){f({type:"error",content:"Errore nell'aggiornare il saldo: ".concat(s.message)}),h(!1);return}h(!1),f({type:"success",content:"Richiesta di prelievo inviata con successo! Sar\xe0 processata entro 48 ore."}),d(5e3),g.refresh()};return(0,a.jsxs)("form",{onSubmit:N,className:"bg-background-secondary/80 backdrop-blur-md border border-white/10 p-6 rounded-2xl shadow-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-heading font-bold text-white mb-6",children:"Richiedi un Prelievo"}),y.content&&(0,a.jsx)("div",{className:"p-3 rounded-lg mb-4 text-sm ".concat("error"===y.type?"bg-red-500/20 text-red-300":"bg-green-500/20 text-green-300"),children:y.content}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{htmlFor:"creds",className:"block text-sm font-medium text-gray-300 mb-1",children:["Creds da Prelevare (Min. ",5e3,")"]}),(0,a.jsx)("input",{type:"number",id:"creds",value:u,onChange:e=>d(Math.max(0,parseInt(e.target.value)||0)),step:100,className:"w-full px-4 py-3 bg-background-main border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary"}),(0,a.jsxs)("p",{className:"text-sm text-primary mt-1",children:["Valore: $",j," USD"]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"paypal",className:"block text-sm font-medium text-gray-300 mb-1",children:"Tua Email PayPal"}),(0,a.jsx)("input",{type:"email",id:"paypal",value:m,onChange:e=>p(e.target.value),placeholder:"la-tua-email@paypal.com",required:!0,className:"w-full px-4 py-3 bg-background-main border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary"})]}),(0,a.jsx)("button",{type:"submit",disabled:b||c<5e3,className:"w-full bg-primary text-background-main font-bold py-3 px-4 rounded-lg transition-all flex items-center justify-center disabled:bg-gray-600 disabled:cursor-not-allowed hover:enabled:bg-opacity-90",children:b?(0,a.jsx)(i.A,{className:"animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{className:"w-5 h-5 mr-2"}),"Richiedi $",j]})}),c<5e3&&(0,a.jsxs)("p",{className:"text-center text-sm text-red-400 mt-2",children:["Devi avere almeno ",5e3," Creds per prelevare."]})]})}},8525:(e,r,t)=>{"use strict";t.d(r,{U:()=>s});var a=t(3587);function s(){return(0,a.createBrowserClient)("https://siojtnnsjagksuhxrwpi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNpb2p0bm5zamFna3N1aHhyd3BpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NTY3MTYsImV4cCI6MjA3NjIzMjcxNn0.EmfZZZ6AlEoZoTwkReD6a2LRnHekaan-RGnt1fEa3c8")}}},e=>{e.O(0,[929,441,255,358],()=>e(e.s=106)),_N_E=e.O()}]);